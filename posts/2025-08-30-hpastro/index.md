---
title: ホームページを Astro で作り直した
draft: true
date: 2025-08-30
tags: [dev, web]
---

ホームページのリニューアルの時に考えていたことや流れをまとめました。また誰かが作り直すときの参考になれば幸いです。だらだら書いているので長いです。

## 以前のMCCのホームページ

Next.js に Velite.js や next-mdx-remote 等を組み合わせてブログを構成していました。

また、スタイリングには CSS Modules を用いており、一部 Tailwind CSS に移行された状態でした。

(作者・メンテナーともに僕です＼(^O^)／)

## リニューアルのきっかけ

もちろん、前々から様々な理由で改修の必要性は感じていたのですが、決め手は Next.js のバグを踏んだことです。 

Cloudflare Pages から Cloudflare Workers へ移行する際、依存を一通りアップデートしたところ以下の Issue と同様のエラーに遭遇しました。

https://github.com/vercel/next.js/issues/58171

このエラー、静的生成のときだけ起こるようで、例えば OpenNext 等を使うと起こりません。
(注: Cloudflare で Next.js を使用する場合、基本的には静的生成するかOpenNextを使うかの2択です)

というわけで、Astro を気に入っていたのもあり、Next.js をやめました。

## 移行の方針について

最低限の目標は以下の通りでした。

- 中身がほぼ同じな `blog`, `news` を `posts` に統合し、タグで管理する
- `/about` ベージを消し、トップページのボリュームを増やす
- 新たに `workshops` カテゴリを生やし、部内の講習資料を Astro Starlight のように作れるようにする

それに伴い、以下の点も意識しました。

- デザインをかっこよくする (僕の趣味ですすみません)
- スタイリングを Tailwind CSS に統一し、デザイントークンの管理を改善する
- 期限のギリギリまで本番にマージしない。一旦リリースしてしまうとやりきった感で中途半端なまま放置してしまうだろうから

## デザインする

デザインは得意ではなく、すぐCSSで細かいところを書いてしまうのですが、今回は意識してまずは全体のイメージをFigmaに起こすことにしました。

### インプット

まずは Pinterest でアイデアを集めます。毎日見てたらおすすめがこんな調子になってしまいました。


とは言えこれらをそのまま Web デザインとして取り入れることはできません。見づらくならない程度に僕のできる範囲でかっこよくします。

### 記事一覧のデザイン

従来は記事のサムネ画像も表示していたのですが、サムネ画像が9割方フォールバックのMCCロゴだったので、画像は表示せず、[Zenn](https://zenn.dev)のように2カラムのUIにしました。

見づらくならないよう、複雑すぎる図形は避けました。

う〜んなんかダサいですが、時間もないのでとりあえずこれでいきます。

### トップページのデザイン

続いてはトップベージです。スクロールドリブンアニメーションかスクロールトリガーアニメーションを使い、画面全体を使ったセクションを数個用意します。

スクロールハックがアクセシビリティ的に良くないのは知っていますが、僕は好きです。スクロールスナップは我慢して使いませんでした。

1セクション目のロゴアニメーションは1年ほど前に Blender で作成したものです。個人的に気に入っているので引き続き使用します。[神椿のHP](https://kamitsubaki.jp)の影響を受けています。

2セクション目はサークルの概要です。PC版で空間が余ったので fetch 系コマンドの出力っぽいものを作りました。

3セクション目は活動内容のページです。早速ネタ切れしてきてスカスカなのが目立ちます。

4セクション目のデザインは存在しません。疲れてしまいました。

### サイドバーのデザイン

不満は少ないので流用します。なぜか X でプチバズした奴です。これを初めて作ったときから `clip-path` に取り憑かれています。


## 実装する

### ページング

記事数が少ないので後回しでもいいのですが、絶対に面倒くさくなるので今のうちにやります。誰かが出してるテンプレートを見ながら書きました。

### 検索機能

後回しです。デザインで検索ボックスの配置は済んでいるのですが、検索結果の表示画面を作る余裕がなさそうだったためです。

実装には Pagefind を使う予定です。

### デザイン済みのページ

デザインをもとに実装していきます。変な形状ばかり使うせいで `clip-path` 祭りです。全部手書きです。とても大変です。`clip-path` 管理のベストプラクティス募集中です。

また、デザイン時には省いたホバー時のエフェクトも用意しつつ、レスポンシブ対応をチェックしながら進めます。

### デザインのないページ・コンポーネント

時間がないのでその場のノリで書きます。レスポンシブのチェックだけは必ず行います。

記事本体のページは、Astroの content collection の恩恵を受けつつ、ベーススタイルは `tailwindcss-typography` を使用しました。それ以外の部分はデザインすらしていないので、統一感はありませんが、文章は読みにくくないのでひとまず良しとします。


細かい部分だったら即席でもちょっとイイ感じ(?)の書けるんですけどねぇ……。